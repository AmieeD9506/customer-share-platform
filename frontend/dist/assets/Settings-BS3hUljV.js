import{_ as h,d as m,e as b,o as c,c as u,a as e,t as l,b as v,v as p,n as J,F as N,g as Z,i as x}from"./index-C7Hz5TA7.js";const y={class:"settings-container"},I={class:"header"},C={class:"user-info"},L={class:"user-name"},O={class:"user-branch"},k={class:"content"},H={class:"section"},T={class:"form-group"},U={class:"input-wrapper"},V={class:"form-group"},w={class:"input-wrapper"},B={class:"form-actions"},F={class:"total-ratio"},D={class:"section"},E={class:"branch-list"},W={class:"branch-header"},X={class:"branch-name"},Y={class:"branch-code"},M={class:"branch-input"},z=["onUpdate:modelValue"],G={__name:"Settings",setup(Q){const g=m(JSON.parse(localStorage.getItem("user"))),r=m([{name:"常州分公司",code:"CZ",limit:10},{name:"杭州分公司",code:"HZ",limit:15},{name:"合肥分公司",code:"HF",limit:12},{name:"湖州分公司",code:"HUZ",limit:8},{name:"嘉兴分公司",code:"JX",limit:10},{name:"济南分公司",code:"JN",limit:15},{name:"连云港分公司",code:"LYG",limit:12},{name:"南京分公司",code:"NJ",limit:20},{name:"南通分公司",code:"NT",limit:10},{name:"宁波分公司",code:"NB",limit:15},{name:"青岛分公司",code:"QD",limit:18},{name:"上海分公司",code:"SH",limit:25},{name:"苏州分公司",code:"SZ",limit:20},{name:"泰州分公司",code:"TZ",limit:10},{name:"天津分公司",code:"TJ",limit:15},{name:"潍坊分公司",code:"WF",limit:12},{name:"武汉分公司",code:"WH",limit:18},{name:"无锡分公司",code:"WX",limit:15},{name:"徐州分公司",code:"XZ",limit:10},{name:"盐城分公司",code:"YC",limit:12},{name:"扬州分公司",code:"YZ",limit:10},{name:"镇江分公司",code:"ZJ",limit:8}]),a=m({shareRatio:60,retrieveRatio:40}),d=x(()=>a.value.shareRatio+a.value.retrieveRatio),_=()=>{const s=d.value;return s===100?"valid":s>100?"invalid-high":s<100?"invalid-low":"valid"},R=()=>{const s=d.value;if(s!==100){alert(`共享方和捞取方的结算比例之和必须为100%！
当前总和：`+s+"%");return}localStorage.setItem("ratioSettings",JSON.stringify({shareRatio:a.value.shareRatio,retrieveRatio:a.value.retrieveRatio})),alert(`结算比例设置已保存！
共享方：`+a.value.shareRatio+`%
捞取方：`+a.value.retrieveRatio+"%")},f=()=>{const s={};r.value.forEach(t=>{s[t.code]=t.limit}),localStorage.setItem("branchLimits",JSON.stringify(s)),alert("每日共享上限设置已保存！")};return b(()=>{const s=JSON.parse(localStorage.getItem("user"));s&&console.log("当前用户:",s);const t=localStorage.getItem("ratioSettings");if(t){const o=JSON.parse(t);a.value.shareRatio=o.shareRatio,a.value.retrieveRatio=o.retrieveRatio}const n=localStorage.getItem("branchLimits");if(n){const o=JSON.parse(n);r.value.forEach(i=>{o[i.code]&&(i.limit=o[i.code])})}}),(s,t)=>{var n,o;return c(),u("div",y,[e("div",I,[t[2]||(t[2]=e("h1",null,"系统设置",-1)),e("div",C,[e("span",L,l((n=g.value)==null?void 0:n.username),1),e("span",O,l((o=g.value)==null?void 0:o.branch),1)])]),e("div",k,[e("div",H,[t[8]||(t[8]=e("h2",null,"配置结算比例",-1)),t[9]||(t[9]=e("p",{class:"section-desc"},"设置共享方和捞取方的结算比例，两者之和必须为100%",-1)),e("div",T,[t[4]||(t[4]=e("label",{for:"shareRatio"},"共享方结算比例：",-1)),e("div",U,[v(e("input",{type:"number",id:"shareRatio","onUpdate:modelValue":t[0]||(t[0]=i=>a.value.shareRatio=i),min:"0",max:"100",placeholder:"请输入比例"},null,512),[[p,a.value.shareRatio]]),t[3]||(t[3]=e("span",{class:"percentage"},"%",-1))])]),e("div",V,[t[6]||(t[6]=e("label",{for:"retrieveRatio"},"捞取方结算比例：",-1)),e("div",w,[v(e("input",{type:"number",id:"retrieveRatio","onUpdate:modelValue":t[1]||(t[1]=i=>a.value.retrieveRatio=i),min:"0",max:"100",placeholder:"请输入比例"},null,512),[[p,a.value.retrieveRatio]]),t[5]||(t[5]=e("span",{class:"percentage"},"%",-1))])]),e("div",B,[e("button",{onClick:R,class:"save-btn"},"保存设置"),e("div",F,[t[7]||(t[7]=e("span",{class:"label"},"当前总和：",-1)),e("span",{class:J(_())},l(d.value)+"% ",3)])])]),e("div",D,[t[11]||(t[11]=e("h2",null,"配置每日共享上限",-1)),t[12]||(t[12]=e("p",{class:"section-desc"},"设置每个分公司的员工每日可共享的客户数量上限",-1)),e("div",E,[(c(!0),u(N,null,Z(r.value,i=>(c(),u("div",{key:i.name,class:"branch-item"},[e("div",W,[e("span",X,l(i.name),1),e("span",Y,"("+l(i.code)+")",1)]),e("div",M,[t[10]||(t[10]=e("label",null,"每日共享上限：",-1)),v(e("input",{type:"number","onUpdate:modelValue":S=>i.limit=S,min:"0",max:"999",placeholder:"请输入上限",class:"limit-input"},null,8,z),[[p,i.limit]])])]))),128))]),e("div",{class:"form-actions"},[e("button",{onClick:f,class:"save-btn"},"保存设置")])])])])}}},q=h(G,[["__scopeId","data-v-d47f024a"]]);export{q as default};
